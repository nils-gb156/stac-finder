<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STAC Collection Details</title>
    <link rel="icon" type="image/png" href="/assets/images/STACFinder_logo.png">
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 2rem auto; line-height: 1.6; padding: 0 1rem; }
        h1 { border-bottom: 2px solid #eee; padding-bottom: 0.5rem; }
        .meta-block { background: #f9f9f9; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
        .label { font-weight: bold; color: #555; }
        pre { background: #333; color: #fff; padding: 1rem; overflow-x: auto; border-radius: 4px; }
        a.back-link { display: inline-block; margin-bottom: 1rem; text-decoration: none; color: #007bff; }
        a.back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <a href="/collections" class="back-link">← Zurück zur Übersicht</a>

    <div id="content">
        <h1>Lade Collection...</h1>
    </div>

    <script>
        async function loadCollection() {
            try {
                // Wir rufen die aktuelle URL auf, erzwingen aber JSON Format
                const url = new URL(window.location.href);
                url.searchParams.set('f', 'json');

                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const data = await response.json();
                render(data);
            } catch (err) {
                document.getElementById('content').innerHTML = `<p style="color:red">Fehler beim Laden: ${err.message}</p>`;
            }
        }

        function render(data) {
            const content = document.getElementById('content');
            
            // Zeiträume formatieren
            const interval = data.extent?.temporal?.interval?.[0] || [];
            const timeStr = `${interval[0] || 'Unbekannt'} bis ${interval[1] || 'Unbekannt'}`;

            // BBox
            const bbox = data.extent?.spatial?.bbox?.[0]?.map(n => n.toFixed(4)).join(', ') || 'Keine Angabe';

            content.innerHTML = `
                <h1>${data.title || data.id} <small style="font-size:0.5em; color:#999">(${data.id})</small></h1>
                <p>${data.description || 'Keine Beschreibung verfügbar.'}</p>
                
                <div class="meta-block">
                    <div><span class="label">Lizenz:</span> ${data.license || 'n/a'}</div>
                    <div><span class="label">Zeitraum:</span> ${timeStr}</div>
                    <div><span class="label">Gebiet (BBox):</span> [${bbox}]</div>
                    <div><span class="label">Keywords:</span> ${(data.keywords || []).join(', ')}</div>
                </div>

                <h3>STAC JSON (Rohdaten)</h3>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
        }

        loadCollection();
    </script>
</body>
</html>
