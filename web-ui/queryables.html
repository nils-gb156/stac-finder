<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STACFinder | Queryables</title>
    <link rel="icon" type="image/png" href="/assets/images/STACFinder_logo.png">
</head>
<body>
    <h1>Queryables (filterbare Felder)</h1>
    <p>Diese Felder k√∂nnen in CQL2-Filtern auf <code>/collections</code> verwendet werden.</p>

    <ul id="queryables"></ul>

    <script>
        // Holt das JSON vom Endpoint /collections/queryables
        fetch('/collections/queryables')
            .then((r) => {
                if (!r.ok) {
                    throw new Error('Request failed with status ' + r.status);
                }
                return r.json();
            })
            .then((data) => {
                const list = document.getElementById('queryables');

                if (!data.properties || Object.keys(data.properties).length === 0) {
                    list.innerHTML = '<li>Keine Queryables definiert.</li>';
                    return;
                }

                list.innerHTML = Object.entries(data.properties)
                    .map(([name, def]) => {
                        const type = def.type || 'unbekannter Typ';
                        const title = def.title || name;
                        const description = def.description || '';
                        return `
                            <li>
                                <strong>${name}</strong> (${type})<br>
                                <em>${title}</em><br>
                                <span>${description}</span>
                            </li>
                        `;
                    })
                    .join('');
            })
            .catch((err) => {
                console.error(err);
                const list = document.getElementById('queryables');
                list.innerHTML = '<li>Fehler beim Laden der Queryables.</li>';
            });
    </script>
</body>
</html>
